{"remainingRequest":"/Users/zhuwenyan/study/editor/node_modules/babel-loader/lib/index.js!/Users/zhuwenyan/study/editor/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhuwenyan/study/editor/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuwenyan/study/editor/src/components/TextEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhuwenyan/study/editor/src/components/TextEditor.vue","mtime":1616944027676},{"path":"/Users/zhuwenyan/study/editor/node_modules/cache-loader/dist/cjs.js","mtime":1612769163499},{"path":"/Users/zhuwenyan/study/editor/node_modules/babel-loader/lib/index.js","mtime":1608107598057},{"path":"/Users/zhuwenyan/study/editor/node_modules/cache-loader/dist/cjs.js","mtime":1612769163499},{"path":"/Users/zhuwenyan/study/editor/node_modules/vue-loader/lib/index.js","mtime":1610004437356}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdUZXh0RWRpdG9yJywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgIGVkaXRhYmxlOiBmYWxzZSwKICAgICAgZm9ybURhdGE6IHsKICAgICAgICB1cmw6ICcnCiAgICAgIH0sCiAgICAgIHNlbGVjdEVsZW1lbnQ6IG51bGwsCiAgICAgIHBvc2l0aW9uOiB7CiAgICAgICAgc3RhcnQ6IDAsCiAgICAgICAgZW5kOiAwCiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkge30sCiAgbWV0aG9kczogewogICAgYWRkTGluazogZnVuY3Rpb24gYWRkTGluaygpIHsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5saW5rRGF0YS50ZXh0ID0gJyc7CiAgICAgIHZhciBzZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTsKICAgICAgdGhpcy5zZWxlY3RFbGVtZW50ID0gc2VsZWN0aW9uLmJhc2VOb2RlOwogICAgICB0aGlzLnBvc2l0aW9uLmFuY2hvck9mZnNldCA9IHNlbGVjdGlvbi5hbmNob3JPZmZzZXQ7CiAgICAgIHRoaXMucG9zaXRpb24uZm9jdXNPZmZzZXQgPSBzZWxlY3Rpb24uZm9jdXNPZmZzZXQ7CiAgICB9LAogICAgb25TYXZlTGluazogZnVuY3Rpb24gb25TYXZlTGluaygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJHJlZnMuZm9ybURlZi52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHZhciBzVGV4dCA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpOwogICAgICAgICAgaWYgKCFzVGV4dCkgcmV0dXJuOwoKICAgICAgICAgIGlmIChfdGhpcy5lZGl0YWJsZSkgey8vIHRoaXMuc2VsZWN0TGluayh0aGlzLmN1cnJlbnRMaW5rKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKICAgICAgICAgICAgdmFyIHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsKICAgICAgICAgICAgdmFyIHJhbmdlRGl2RG9tID0gX3RoaXMuc2VsZWN0RWxlbWVudDsKICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocmFuZ2VEaXZEb20sIF90aGlzLnBvc2l0aW9uLmFuY2hvck9mZnNldCk7CiAgICAgICAgICAgIHJhbmdlLnNldEVuZChyYW5nZURpdkRvbSwgX3RoaXMucG9zaXRpb24uZm9jdXNPZmZzZXQpOwogICAgICAgICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7CiAgICAgICAgICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7CiAgICAgICAgICB9CgogICAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2luc2VydEhUTUwnLCBmYWxzZSwgIjxhIGhyZWY9XCIiLmNvbmNhdChfdGhpcy5saW5rRGF0YS50ZXh0LCAiXCIgdGFyZ2V0PVwiX2JsYW5rXCI+IikuY29uY2F0KHNUZXh0LCAiPC9hPiIpKTsKICAgICAgICAgIF90aGlzLnZpc2libGUgPSBmYWxzZTsgLy8gdGhpcy5vbkxpc3RlbmVyTGluaygpCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["TextEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,eAAA;AACA,EAAA,IAAA,EAAA,YADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,OAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA,KAFA;AAGA,MAAA,QAAA,EAAA;AACA,QAAA,GAAA,EAAA;AADA,OAHA;AAMA,MAAA,aAAA,EAAA,IANA;AAOA,MAAA,QAAA,EAAA;AACA,QAAA,KAAA,EAAA,CADA;AAEA,QAAA,GAAA,EAAA;AAFA;AAPA,KAAA;AAYA,GAfA;AAgBA,EAAA,OAhBA,qBAgBA,CACA,CAjBA;AAkBA,EAAA,OAAA,EAAA;AACA,IAAA,OADA,qBACA;AACA,WAAA,OAAA,GAAA,IAAA;AACA,WAAA,QAAA,CAAA,IAAA,GAAA,EAAA;AACA,UAAA,SAAA,GAAA,QAAA,CAAA,YAAA,EAAA;AACA,WAAA,aAAA,GAAA,SAAA,CAAA,QAAA;AACA,WAAA,QAAA,CAAA,YAAA,GAAA,SAAA,CAAA,YAAA;AACA,WAAA,QAAA,CAAA,WAAA,GAAA,SAAA,CAAA,WAAA;AACA,KARA;AASA,IAAA,UATA,wBASA;AAAA;;AACA,WAAA,KAAA,CAAA,OAAA,CAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,KAAA,GAAA,QAAA,CAAA,YAAA,EAAA;AACA,cAAA,CAAA,KAAA,EAAA;;AACA,cAAA,KAAA,CAAA,QAAA,EAAA,CACA;AACA,WAFA,MAEA;AACA,gBAAA,SAAA,GAAA,MAAA,CAAA,YAAA,EAAA;AACA,gBAAA,KAAA,GAAA,QAAA,CAAA,WAAA,EAAA;AACA,gBAAA,WAAA,GAAA,KAAA,CAAA,aAAA;AACA,YAAA,KAAA,CAAA,QAAA,CAAA,WAAA,EAAA,KAAA,CAAA,QAAA,CAAA,YAAA;AACA,YAAA,KAAA,CAAA,MAAA,CAAA,WAAA,EAAA,KAAA,CAAA,QAAA,CAAA,WAAA;AACA,YAAA,SAAA,CAAA,eAAA;AACA,YAAA,SAAA,CAAA,QAAA,CAAA,KAAA;AACA;;AACA,UAAA,QAAA,CAAA,WAAA,CAAA,YAAA,EAAA,KAAA,sBAAA,KAAA,CAAA,QAAA,CAAA,IAAA,kCAAA,KAAA;AACA,UAAA,KAAA,CAAA,OAAA,GAAA,KAAA,CAfA,CAgBA;AACA;AACA,OAnBA;AAoBA;AA9BA;AAlBA,CAAA","sourcesContent":["<template>\n  <div id=\"text-container\">\n    <!-- 工具栏 -->\n    <div id=\"control-area\">\n      <a class=\"link\" href=\"#\" @click=\"addLink\">#插入链接</a>\n    </div>\n    <!-- 文本编辑器 -->\n    <div id=\"text-area\" contenteditable></div>\n    <!-- 插入链接 -->\n    <el-dialog\n      width=\"30%\"\n      title=\"插入链接\"\n      :visible.sync=\"visible\"\n      append-to-body>\n      <el-form class=\"text-form\" ref=\"formDef\" :model=\"formData\">\n        <el-form-item label=\"链接\" prop=\"url\" required>\n          <el-input placeholder=\"请输入链接\" v-model=\"formData.url\"></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"visible = false\">取 消</el-button>\n\n        <el-button type=\"primary\" @click=\"onSaveLink\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'TextEditor',\n  data() {\n    return {\n      visible: false,\n      editable: false,\n      formData: {\n        url: ''\n      },\n      selectElement: null,\n      position: {\n        start: 0,\n        end: 0\n      }\n    }\n  },\n  created() {\n  },\n  methods: {\n    addLink() {\n      this.visible = true\n      this.linkData.text = ''\n      const selection = document.getSelection()\n      this.selectElement = selection.baseNode\n      this.position.anchorOffset = selection.anchorOffset\n      this.position.focusOffset = selection.focusOffset\n    },\n    onSaveLink() {\n      this.$refs.formDef.validate(valid => {\n        if (valid) {\n          const sText = document.getSelection()\n          if (!sText) return\n          if (this.editable) {\n            // this.selectLink(this.currentLink)\n          } else {\n            const selection = window.getSelection()\n            const range = document.createRange()\n            const rangeDivDom = this.selectElement;\n            range.setStart(rangeDivDom, this.position.anchorOffset)\n            range.setEnd(rangeDivDom, this.position.focusOffset)\n            selection.removeAllRanges()\n            selection.addRange(range)\n          }\n          document.execCommand('insertHTML', false, `<a href=\"${this.linkData.text}\" target=\"_blank\">${sText}</a>`);\n          this.visible = false\n          // this.onListenerLink()\n        }\n      });\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n// 编辑器\n#text-container {\n  #control-area {\n    .link {\n      height: 30px;\n      line-height: 30px;\n      display: inline-block;\n      &:first-child {\n        margin-right: 20px;\n      }\n      &:hover {\n        color: #409eff;\n      }\n    }\n  }\n  #text-area{\n    width: 90%;\n    height: 300px;\n    line-height: 1.5;\n    border: 1px solid #DCDFE6;\n    padding: 5px 15px;\n    box-sizing: border-box;\n    color: #606266;\n    font-size: 14px;\n    border-radius: 4px;\n  }\n}\n</style>\n"],"sourceRoot":"src/components"}]}